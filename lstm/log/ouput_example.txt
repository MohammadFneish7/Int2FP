tensorflow version: 2.0.0-dev20190327

Defining Hyper-Parameters...
---------------------------------------------------------------
start time: 2019-04-30 19:06:51.663454
data path: data/USDJPY_Candlestick_15_M_BID_05.05.2003-31.12.2018.csv
checkpoint path: checkpoints/LSTM_00000014_20190429_202523.h5
resuming from checkpoint: False
automatic checkpoint period: 1
pip decimal place: 3
add taforex features: True
time steps: 100
look farword: 50
number of classes: 1
number of epochs: 3
batch size: 1
LSTM stateful LSTM: True
hidden layers: 0
drop out: 0.3
LSTM output units: 32
label type: future_regression_angle
debug future regression angle: False

Reading Data...
---------------------------------------------------------------
         Open        High         Low       Close       Volume
0  118.940002  119.015999  118.926003  118.950996  3468.199951
1  118.946999  118.974998  118.932999  118.948997  3108.899902
2  118.954002  118.974998  118.892998  118.959000  3083.300049
3  118.966003  118.990997  118.922997  118.975998  2914.600098
4  118.992996  119.000000  118.967003  118.985001  3088.800049
5  118.987999  119.001999  118.953003  118.987999  3175.399902
6  118.987000  119.023003  118.973000  118.984001  3237.600098
7  118.989998  119.002998  118.973999  118.995003  2998.899902
8  118.990997  119.039001  118.990997  118.995003  2742.199951
9  118.999001  119.032997  118.973000  119.008003  3151.699951

Adding Features...
---------------------------------------------------------------
C:\Program Files\Python36\lib\site-packages\ta\trend.py:170: RuntimeWarning: divide by zero encountered in double_scalars
  dip[i] = 100 * (dip_mio[i]/trs[i])
C:\Program Files\Python36\lib\site-packages\ta\trend.py:170: RuntimeWarning: invalid value encountered in double_scalars
  dip[i] = 100 * (dip_mio[i]/trs[i])
C:\Program Files\Python36\lib\site-packages\ta\trend.py:174: RuntimeWarning: divide by zero encountered in double_scalars
  din[i] = 100 * (din_mio[i]/trs[i])
C:\Program Files\Python36\lib\site-packages\ta\trend.py:174: RuntimeWarning: invalid value encountered in double_scalars
  din[i] = 100 * (din_mio[i]/trs[i])
C:\Program Files\Python36\lib\site-packages\ta\trend.py:176: RuntimeWarning: invalid value encountered in subtract
  dx = 100 * np.abs((dip - din) / (dip + din))

input features:
---------------------------------------------------------------
['Open', 'High', 'Low', 'Close', 'Volume', 'volume_adi', 'volume_obv', 'volume_obvm', 'volume_cmf', 'volume_fi', 'volume_em', 'volume_vpt', 'volume_nvi', 'volatility_atr', 'volatility_bbh', 'volatility_bbl', 'volatility_bbm', 'volatility_bbhi', 'volatility_bbli', 'volatility_kcc', 'volatility_kch', 'volatility_kcl', 'volatility_kchi', 'volatility_kcli', 'volatility_dch', 'volatility_dcl', 'volatility_dchi', 'volatility_dcli', 'trend_macd', 'trend_macd_signal', 'trend_macd_diff', 'trend_ema_fast', 'trend_ema_slow', 'trend_adx', 'trend_adx_pos', 'trend_adx_neg', 'trend_vortex_ind_pos', 'trend_vortex_ind_neg', 'trend_vortex_diff', 'trend_trix', 'trend_mass_index', 'trend_cci', 'trend_dpo', 'trend_kst', 'trend_kst_sig', 'trend_kst_diff', 'trend_ichimoku_a', 'trend_ichimoku_b', 'trend_visual_ichimoku_a', 'trend_visual_ichimoku_b', 'trend_aroon_up', 'trend_aroon_down', 'trend_aroon_ind', 'momentum_rsi', 'momentum_mfi', 'momentum_tsi', 'momentum_uo', 'momentum_stoch', 'momentum_stoch_signal', 'momentum_wr', 'momentum_ao', 'others_dr', 'others_dlr', 'others_cr']

         Open        High         Low       Close       Volume   volume_adi   volume_obv  volume_obvm  ...  momentum_uo  momentum_stoch  momentum_stoch_signal  momentum_wr  momentum_ao  others_dr  others_dlr  others_cr
0  118.940002  119.015999  118.926003  118.950996  3468.199951 -1473.404541     0.000000     0.000000  ...    99.562064       27.772126              27.772126   -72.227874          0.0  14.185929    0.000000   0.000000
1  118.946999  118.974998  118.932999  118.948997  3108.899902 -2282.189941 -3108.899902 -1554.449951  ...    99.388620       25.551034              26.661580   -74.448966          0.0  -0.001681   -0.001717  -0.001681
2  118.954002  118.974998  118.892998  118.959000  3083.300049  1139.783447  3083.300049    -8.533285  ...    99.285075       53.659596              35.660919   -46.340404          0.0   0.008404    0.008440   0.006723
3  118.966003  118.990997  118.922997  118.975998  2914.600098  3508.973633  2914.600098   722.250061  ...    99.188545       67.479221              48.896617   -32.520779          0.0   0.014293    0.014257   0.021017
4  118.992996  119.000000  118.967003  118.985001  3088.800049  1909.484619  3088.800049  1195.560059  ...    99.090777       74.798412              65.312410   -25.201588          0.0   0.007570    0.007582   0.028586

[5 rows x 64 columns]

Partitioning dataset...
---------------------------------------------------------------
Train Partition:
(260400, 64)
[[ 1.18940002e+02  1.19015999e+02  1.18926003e+02  1.18950996e+02
   3.46819995e+03 -1.47340454e+03  0.00000000e+00  0.00000000e+00
  -4.44557488e-01  0.00000000e+00  0.00000000e+00  4.91967590e+02
   1.00000000e+03  9.50627401e-02  1.18952827e+02  1.18947166e+02
   1.18950996e+02  0.00000000e+00  0.00000000e+00  1.18964333e+02
   1.19054329e+02  1.18874336e+02  0.00000000e+00  0.00000000e+00
   1.18950996e+02  1.18950996e+02  0.00000000e+00  0.00000000e+00
   0.00000000e+00  0.00000000e+00  0.00000000e+00  1.18950996e+02
   1.18950996e+02  0.00000000e+00  0.00000000e+00  0.00000000e+00
   1.00000000e+00  1.00000000e+00  0.00000000e+00  1.41852713e+01
   1.00000000e+00  0.00000000e+00 -1.47779160e+01  1.41859268e+02
   1.41859268e+02  0.00000000e+00  1.18971001e+02  1.18971001e+02
   1.04168053e+02  1.04161789e+02  4.00000000e+00  4.00000000e+00
   0.00000000e+00  5.00000000e+01  1.00000000e+02  1.00000000e+02
   9.95620651e+01  2.77721252e+01  2.77721252e+01 -7.22278748e+01
   0.00000000e+00  1.41859293e+01  0.00000000e+00  0.00000000e+00]
 [ 1.18946999e+02  1.18974998e+02  1.18932999e+02  1.18948997e+02
   3.10889990e+03 -2.28218994e+03 -3.10889990e+03 -1.55444995e+03
  -3.46990287e-01  0.00000000e+00 -2.29690670e-07  4.91944031e+02
   9.99983215e+02  9.12725329e-02  1.18952827e+02  1.18947166e+02
   1.18949997e+02  0.00000000e+00  0.00000000e+00  1.18958328e+02
   1.19024330e+02  1.18892334e+02  0.00000000e+00  0.00000000e+00
   1.18950996e+02  1.18948997e+02  0.00000000e+00  0.00000000e+00
  -4.48471474e-05 -2.49150817e-05 -1.99320657e-05  1.18949913e+02
   1.18949959e+02  0.00000000e+00  0.00000000e+00  0.00000000e+00
   1.00000000e+00  1.00000000e+00  0.00000000e+00 -2.54929124e-04
   1.84237051e+00 -4.71404533e+01 -1.47769165e+01  1.41849670e+02
   1.41854462e+02 -4.79817390e-03  1.18971001e+02  1.18971001e+02
   1.04168053e+02  1.04161789e+02  4.00000000e+00  8.00000000e+00
  -4.00000000e+00  0.00000000e+00  5.27339630e+01  9.99902802e+01
   9.93886185e+01  2.55510349e+01  2.66615810e+01 -7.44489670e+01
   0.00000000e+00 -1.68085098e-03 -1.71661377e-03 -1.68085098e-03]
 [ 1.18954002e+02  1.18974998e+02  1.18892998e+02  1.18959000e+02
   3.08330005e+03  1.13978345e+03  3.08330005e+03 -8.53328419e+00
  -4.16163690e-02 -3.08044434e+00 -3.80802618e-07  2.07024068e-01
   1.00006726e+03  9.06102583e-02  1.18963585e+02  1.18942413e+02
   1.18952995e+02  0.00000000e+00  0.00000000e+00  1.18952995e+02
   1.19024330e+02  1.18881668e+02  0.00000000e+00  0.00000000e+00
   1.18959000e+02  1.18948997e+02  0.00000000e+00  0.00000000e+00
   2.53021484e-04  8.89933435e-05  1.64028141e-04  1.18953461e+02
   1.18953209e+02  0.00000000e+00  0.00000000e+00  0.00000000e+00
   1.00000000e+00  1.00000000e+00  0.00000000e+00  2.69627810e-04
   2.80863142e+00 -6.45591278e+01 -1.47799177e+01  1.41878464e+02
   1.41862473e+02  1.60038471e-02  1.18954498e+02  1.18954498e+02
   1.04168053e+02  1.04161789e+02  1.20000000e+01  8.00000000e+00
   4.00000000e+00  8.52368774e+01  6.78184052e+01  9.99866791e+01
   9.92850723e+01  5.36595955e+01  3.56609192e+01 -4.63404045e+01
   0.00000000e+00  8.40425491e-03  8.44001770e-03  6.72340393e-03]
 [ 1.18966003e+02  1.18990997e+02  1.18922997e+02  1.18975998e+02
   2.91460010e+03  3.50897363e+03  2.91460010e+03  7.22250061e+02
   9.75573510e-02 -5.24617767e+00 -7.50059925e-08  6.75740361e-01
   1.00021014e+03  8.89953002e-02  1.18983322e+02  1.18934174e+02
   1.18958748e+02  0.00000000e+00  0.00000000e+00  1.18955582e+02
   1.19026077e+02  1.18885078e+02  0.00000000e+00  0.00000000e+00
   1.18975998e+02  1.18948997e+02  0.00000000e+00  0.00000000e+00
   9.96013870e-04  3.96249612e-04  5.99764229e-04  1.18960571e+02
   1.18959579e+02  0.00000000e+00  0.00000000e+00  0.00000000e+00
   1.00000000e+00  1.00000000e+00  0.00000000e+00  7.98009452e-04
   3.77671504e+00  4.98418427e+01 -1.47856674e+01  1.41933670e+02
   1.41880264e+02  5.34011051e-02  1.18954498e+02  1.18954498e+02
   1.04168053e+02  1.04161789e+02  1.60000000e+01  8.00000000e+00
   8.00000000e+00  9.44737015e+01  7.52778473e+01  9.99846954e+01
   9.91885452e+01  6.74792175e+01  4.88966179e+01 -3.25207787e+01
   0.00000000e+00  1.42931938e-02  1.42574310e-02  2.10165977e-02]
 [ 1.18992996e+02  1.19000000e+02  1.18967003e+02  1.18985001e+02
   3.08880005e+03  1.90948462e+03  3.08880005e+03  1.19556006e+03
   9.62380692e-02  1.43005371e-01  1.45313308e-08  6.50196671e-01
   1.00021014e+03  8.49954262e-02  1.18995689e+02  1.18932312e+02
   1.18963997e+02  0.00000000e+00  0.00000000e+00  1.18961266e+02
   1.19024261e+02  1.18898270e+02  0.00000000e+00  0.00000000e+00
   1.18985001e+02  1.18948997e+02  0.00000000e+00  0.00000000e+00
   1.73701381e-03  7.95096683e-04  9.41917184e-04  1.18967209e+02
   1.18965477e+02  0.00000000e+00  0.00000000e+00  0.00000000e+00
   1.00000000e+00  1.00000000e+00  0.00000000e+00  1.16019638e-03
   4.63989162e+00  9.73844223e+01 -1.47909184e+01  1.41984070e+02
   1.41901031e+02  8.30416381e-02  1.18954498e+02  1.18954498e+02
   1.04168053e+02  1.04161789e+02  2.00000000e+01  8.00000000e+00
   1.20000000e+01  9.60022354e+01  8.01538239e+01  9.99833984e+01
   9.90907745e+01  7.47984085e+01  6.53124084e+01 -2.52015877e+01
   0.00000000e+00  7.56978989e-03  7.58171082e-03  2.85863876e-02]
 [ 1.18987999e+02  1.19001999e+02  1.18953003e+02  1.18987999e+02
   3.17539990e+03  1.64141455e+03  3.17539990e+03  1.52553333e+03
   1.52246282e-01  3.12986827e+00 -6.89236668e-09  3.13741803e-01
   1.00021014e+03  8.24240372e-02  1.19002457e+02  1.18933540e+02
   1.18968002e+02  0.00000000e+00  0.00000000e+00  1.18964554e+02
   1.19025223e+02  1.18903893e+02  0.00000000e+00  0.00000000e+00
   1.18987999e+02  1.18948997e+02  0.00000000e+00  0.00000000e+00
   2.27801641e-03  1.19705033e-03  1.08096609e-03  1.18972267e+02
   1.18969986e+02  0.00000000e+00  0.00000000e+00  0.00000000e+00
   1.00000000e+00  1.00000000e+00  0.00000000e+00  1.37108518e-03
   5.50484276e+00  6.81328659e+01 -1.47949181e+01  1.42022461e+02
   1.41921265e+02  1.01200365e-01  1.18954498e+02  1.18954498e+02
   1.04168053e+02  1.04161789e+02  2.40000000e+01  8.00000000e+00
   1.60000000e+01  9.63863373e+01  8.34994125e+01  9.99824600e+01
   9.90011139e+01  7.72360764e+01  7.31712341e+01 -2.27639256e+01
  -1.63345342e-03  2.51531601e-03  2.52723694e-03  3.11017036e-02]
 [ 1.18987000e+02  1.19023003e+02  1.18973000e+02  1.18984001e+02
   3.23760010e+03 -4.52193237e+02 -3.23760010e+03  8.45085754e+02
   4.77995276e-02 -1.48718312e-01  4.70254768e-08 -2.87598744e-02
   1.00021014e+03  8.01082551e-02  1.19003983e+02  1.18936584e+02
   1.18970284e+02  0.00000000e+00  0.00000000e+00  1.18968666e+02
   1.19027809e+02  1.18909523e+02  0.00000000e+00  0.00000000e+00
   1.18987999e+02  1.18948997e+02  0.00000000e+00  0.00000000e+00
   2.40462157e-03  1.50265440e-03  9.01967112e-04  1.18974884e+02
   1.18972481e+02  0.00000000e+00  0.00000000e+00  0.00000000e+00
   1.00000000e+00  1.00000000e+00  0.00000000e+00  1.44226942e-03
   6.38075829e+00  9.00022049e+01 -1.47972040e+01  1.42044418e+02
   1.41938858e+02  1.05554216e-01  1.18958000e+02  1.18958000e+02
   1.04168053e+02  1.04161789e+02  2.40000000e+01  8.00000000e+00
   1.60000000e+01  8.39737930e+01  7.12515640e+01  9.99770050e+01
   9.87472610e+01  7.00000000e+01  7.40114975e+01 -3.00000000e+01
   2.14385986e-03 -3.36170197e-03 -3.38554382e-03  2.77519226e-02]
 [ 1.18989998e+02  1.19002998e+02  1.18973999e+02  1.18995003e+02
   2.99889990e+03 -4.67732544e+02  2.99889990e+03  1.11431250e+03
   9.57287624e-02 -1.23616791e+00  2.71806631e-08  1.68508410e-01
   1.00030267e+03  7.64576197e-02  1.19009140e+02  1.18937614e+02
   1.18973373e+02  0.00000000e+00  0.00000000e+00  1.18971420e+02
   1.19026787e+02  1.18916046e+02  0.00000000e+00  0.00000000e+00
   1.18995003e+02  1.18948997e+02  0.00000000e+00  0.00000000e+00
   2.97408435e-03  1.85626664e-03  1.11781759e-03  1.18979080e+02
   1.18976105e+02  0.00000000e+00  0.00000000e+00  0.00000000e+00
   1.00000000e+00  1.00000000e+00  0.00000000e+00  1.50794338e-03
   7.20179701e+00  6.89004593e+01 -1.48002939e+01  1.42074081e+02
   1.41955765e+02  1.18312642e-01  1.18958000e+02  1.18958000e+02
   1.04168053e+02  1.04161789e+02  3.20000000e+01  8.00000000e+00
   2.40000000e+01  8.86250992e+01  7.46902542e+01  9.99726028e+01
   7.79123611e+01  7.84624405e+01  7.52328415e+01 -2.15375595e+01
   1.04635237e-02  9.25064087e-03  9.25064087e-03  3.69906425e-02]
 [ 1.18990997e+02  1.19039001e+02  1.18990997e+02  1.18995003e+02
   2.74219995e+03 -9.39380371e+02  0.00000000e+00  9.90500000e+02
   4.16567083e-03 -5.45018768e+00  8.17722707e-08  2.77286500e-01
   1.00030267e+03  7.44252279e-02  1.19012207e+02  1.18939346e+02
   1.18975777e+02  0.00000000e+00  0.00000000e+00  1.18975517e+02
   1.19030075e+02  1.18920959e+02  0.00000000e+00  0.00000000e+00
   1.18995003e+02  1.18948997e+02  0.00000000e+00  0.00000000e+00
   3.32317455e-03  2.19512964e-03  1.12804491e-03  1.18982231e+02
   1.18978905e+02  0.00000000e+00  0.00000000e+00  0.00000000e+00
   1.00000000e+00  1.00000000e+00  0.00000000e+00  1.54699304e-03
   8.05658340e+00  1.02575920e+02 -1.48026972e+01  1.42097137e+02
   1.41971466e+02  1.25672624e-01  1.18966003e+02  1.18966003e+02
   1.04168053e+02  1.04161789e+02  3.20000000e+01  8.00000000e+00
   2.40000000e+01  8.86250992e+01  7.46902542e+01  9.99689331e+01
   7.52857666e+01  6.98646622e+01  7.27757034e+01 -3.01353397e+01
   1.71118844e-02  0.00000000e+00  0.00000000e+00  3.69906425e-02]
 [ 1.18999001e+02  1.19032997e+02  1.18973000e+02  1.19008003e+02
   3.15169995e+03 -1.75876782e+03  3.15169995e+03  1.20662000e+03
   2.07202509e-02  1.98647523e+00  4.73021764e-08  3.44330758e-01
   1.00030267e+03  7.33946785e-02  1.19018936e+02  1.18939064e+02
   1.18979004e+02  0.00000000e+00  0.00000000e+00  1.18978432e+02
   1.19033531e+02  1.18923332e+02  0.00000000e+00  0.00000000e+00
   1.19008003e+02  1.18948997e+02  0.00000000e+00  0.00000000e+00
   4.19210829e-03  2.64256890e-03  1.54953939e-03  1.18987114e+02
   1.18982925e+02  0.00000000e+00  0.00000000e+00  0.00000000e+00
   1.00000000e+00  1.00000000e+00  0.00000000e+00  1.61299889e-03
   8.97778606e+00  7.90751724e+01 -1.48059196e+01  1.42128082e+02
   1.42001343e+02  1.26739219e-01  1.18966003e+02  1.18966003e+02
   1.04168053e+02  1.04161789e+02  4.00000000e+01  8.00000000e+00
   3.20000000e+01  9.21908340e+01  7.75168839e+01  9.99657898e+01
   7.21239853e+01  7.87688751e+01  7.56986618e+01 -2.12311230e+01
   1.82495117e-02  1.09195709e-02  1.09195709e-02  4.79221344e-02]]
Test Partition:
(65100, 64)
[[ 1.08363998e+02  1.08470001e+02  1.08355003e+02  1.08456001e+02
   2.07377002e+03  1.97982507e+03  2.07377002e+03  9.78301025e+02
   1.95600227e-01 -2.17300659e+02  1.33497213e-06  2.56041455e+00
   1.43226904e+03  1.77663580e-01  1.08407639e+02  1.07992363e+02
   1.08199997e+02  1.00000000e+00  0.00000000e+00  1.08194801e+02
   1.08346596e+02  1.08042999e+02  0.00000000e+00  0.00000000e+00
   1.08456001e+02  1.08011002e+02  1.00000000e+00  0.00000000e+00
  -1.68676049e-01 -2.74099082e-01  1.05423033e-01  1.08267876e+02
   1.08436554e+02  2.00000000e+01  2.00000000e+01  2.00000000e+01
   1.11183250e+00  8.98834527e-01  2.12998033e-01 -3.69115658e-02
   2.30594063e+01  1.60968643e+02  3.79989631e-02 -6.47115612e+00
  -1.04066572e+01  3.93550134e+00  1.08206253e+02  1.09899506e+02
   1.09434502e+02  1.10067001e+02  1.00000000e+02  7.20000000e+01
   2.80000000e+01  6.74319382e+01  6.10163155e+01 -4.41009750e+01
   6.61646347e+01  9.72222214e+01  8.30097504e+01 -2.77777767e+00
  -7.43634850e-02  8.49008560e-02  8.48770142e-02 -8.82295990e+00]
 [ 1.08454002e+02  1.08634003e+02  1.08424004e+02  1.08580002e+02
   2.91362012e+03  2.98400171e+03  2.91362012e+03  1.44780200e+03
   2.69881487e-01  1.61542496e+02  2.16287094e-06  5.09188271e+00
   1.43226904e+03  1.79973260e-01  1.08488045e+02  1.07953560e+02
   1.08220802e+02  1.00000000e+00  0.00000000e+00  1.08238968e+02
   1.08396065e+02  1.08081863e+02  0.00000000e+00  0.00000000e+00
   1.08580002e+02  1.08011002e+02  1.00000000e+00  0.00000000e+00
  -1.31282806e-01 -2.45535836e-01  1.14253029e-01  1.08315895e+02
   1.08447182e+02  2.00000000e+01  2.00000000e+01  2.00000000e+01
   1.16169643e+00  8.09839666e-01  3.51856709e-01 -3.29707004e-02
   2.30967274e+01  1.79561874e+02 -1.57981869e-02 -5.21343565e+00
  -9.43236351e+00  4.21892786e+00  1.08287506e+02  1.09899506e+02
   1.09310753e+02  1.09970001e+02  1.00000000e+02  6.80000000e+01
   3.20000000e+01  7.36124344e+01  6.94601974e+01 -4.22484932e+01
   6.50624619e+01  9.19160309e+01  8.96859894e+01 -8.08396912e+00
   1.57217141e-02  1.14333630e-01  1.14250183e-01 -8.71871090e+00]
 [ 1.08584999e+02  1.08684998e+02  1.08490997e+02  1.08681999e+02
   3.00016992e+03  4.32258887e+03  3.00016992e+03  1.58234106e+03
   2.58833140e-01  2.09364456e+02  1.99746728e-06  6.14950275e+00
   1.43226904e+03  1.80975184e-01  1.08582397e+02  1.07911102e+02
   1.08246750e+02  1.00000000e+00  0.00000000e+00  1.08290901e+02
   1.08454102e+02  1.08127701e+02  0.00000000e+00  0.00000000e+00
   1.08681999e+02  1.08011002e+02  1.00000000e+00  0.00000000e+00
  -9.23534557e-02 -2.14899361e-01  1.22545898e-01  1.08372223e+02
   1.08464577e+02  2.00000000e+01  2.00000000e+01  2.00000000e+01
   1.14473724e+00  8.27537715e-01  3.17199588e-01 -2.87764072e-02
   2.31966286e+01  1.68652802e+02 -1.92749023e-01 -3.89801884e+00
  -8.39428329e+00  4.49626398e+00  1.08313004e+02  1.09899506e+02
   1.09263000e+02  1.09970001e+02  1.00000000e+02  6.40000000e+01
   3.60000000e+01  7.76398010e+01  7.05740814e+01 -4.01887283e+01
   6.74507904e+01  9.95829773e+01  9.62404099e+01 -4.17020380e-01
   9.66681540e-02  9.39369202e-02  9.38892365e-02 -8.63296413e+00]
 [ 1.08681000e+02  1.08705002e+02  1.08624001e+02  1.08627998e+02
   2.70446997e+03  4.69919678e+02 -2.70446997e+03  1.46179004e+03
   1.99035436e-01 -1.00384798e+01  1.25039799e-06  1.47451472e+00
   1.43155750e+03  1.73834190e-01  1.08642464e+02  1.07901932e+02
   1.08272202e+02  0.00000000e+00  0.00000000e+00  1.08352570e+02
   1.08510666e+02  1.08194466e+02  0.00000000e+00  0.00000000e+00
   1.08681999e+02  1.08011002e+02  0.00000000e+00  0.00000000e+00
  -6.51085526e-02 -1.84941188e-01  1.19832642e-01  1.08411568e+02
   1.08476677e+02  2.00000000e+01  2.00000000e+01  2.00000000e+01
   1.20710802e+00  8.83223772e-01  3.23884279e-01 -2.46328712e-02
   2.31708889e+01  1.48447952e+02 -1.65197372e-01 -2.58912802e+00
  -7.29863596e+00  4.70950794e+00  1.08351501e+02  1.09899506e+02
   1.09263000e+02  1.09970001e+02  9.60000000e+01  6.00000000e+01
   3.60000000e+01  7.10183716e+01  6.92263412e+01 -3.84222679e+01
   6.79500351e+01  8.95800247e+01  9.36930084e+01 -1.04199791e+01
   1.89560071e-01 -4.96864319e-02 -4.96864319e-02 -8.67836475e+00]
 [ 1.08625999e+02  1.08664001e+02  1.08487000e+02  1.08509003e+02
   2.40687012e+03 -4.24598535e+03 -2.40687012e+03  1.07485596e+03
   1.40994072e-01  1.02638802e+02  1.16618821e-06 -3.98035741e+00
   1.42998926e+03  1.74060464e-01  1.08670692e+02  1.07903008e+02
   1.08286850e+02  0.00000000e+00  0.00000000e+00  1.08399696e+02
   1.08556999e+02  1.08242401e+02  0.00000000e+00  0.00000000e+00
   1.08681999e+02  1.08011002e+02  0.00000000e+00  0.00000000e+00
  -5.25133871e-02 -1.58455640e-01  1.05942249e-01  1.08426559e+02
   1.08479073e+02  2.00000000e+01  2.00000000e+01  2.00000000e+01
   1.13748646e+00  8.14387441e-01  3.23099017e-01 -2.08670907e-02
   2.32048340e+01  9.80590286e+01 -2.75848001e-01 -1.44358706e+00
  -6.17996740e+00  4.73638010e+00  1.08351501e+02  1.09899506e+02
   1.09263000e+02  1.09970001e+02  9.20000000e+01  5.60000000e+01
   3.60000000e+01  5.83628044e+01  6.71348648e+01 -3.70321236e+01
   6.28730354e+01  7.34777298e+01  8.75469131e+01 -2.65222683e+01
   2.42594063e-01 -1.09541416e-01 -1.09577179e-01 -8.77839947e+00]
 [ 1.08510002e+02  1.08578003e+02  1.08429001e+02  1.08573997e+02
   2.49484009e+03  5.52236572e+02  2.49484009e+03  1.19255505e+03
   1.70321941e-01  1.13201923e+01  1.44762726e-06 -1.14222527e+00
   1.42998926e+03  1.72270566e-01  1.08707573e+02  1.07903725e+02
   1.08305649e+02  0.00000000e+00  0.00000000e+00  1.08433266e+02
   1.08593071e+02  1.08273468e+02  0.00000000e+00  0.00000000e+00
   1.08681999e+02  1.08011002e+02  0.00000000e+00  0.00000000e+00
  -3.68621647e-02 -1.34136945e-01  9.72747728e-02  1.08449242e+02
   1.08486107e+02  2.00000000e+01  2.00000000e+01  2.00000000e+01
   1.17294908e+00  8.28882873e-01  3.44066173e-01 -1.73584651e-02
   2.32138844e+01  7.96865005e+01 -1.76651761e-01 -8.81723583e-01
  -5.11006737e+00  4.22834396e+00  1.08355499e+02  1.09856995e+02
   1.09241745e+02  1.09970001e+02  8.80000000e+01  5.20000000e+01
   3.60000000e+01  6.25668106e+01  7.35083771e+01 -3.55369949e+01
   6.50628052e+01  8.22727203e+01  8.17768250e+01 -1.77272816e+01
   2.74704963e-01  5.99026680e-02  5.98430634e-02 -8.72375965e+00]
 [ 1.08572998e+02  1.08677002e+02  1.08561996e+02  1.08642998e+02
   2.63558008e+03  3.43774072e+03  2.63558008e+03  1.63196106e+03
   1.94740564e-01  3.06460037e+01  1.99863325e-06  3.16930819e+00
   1.42998926e+03  1.68180212e-01  1.08752945e+02  1.07904755e+02
   1.08328850e+02  0.00000000e+00  0.00000000e+00  1.08480797e+02
   1.08636902e+02  1.08324699e+02  0.00000000e+00  0.00000000e+00
   1.08681999e+02  1.08011002e+02  0.00000000e+00  0.00000000e+00
  -1.86754353e-02 -1.11044638e-01  9.23692062e-02  1.08479050e+02
   1.08497726e+02  2.00000000e+01  2.00000000e+01  2.00000000e+01
   1.24582088e+00  7.60665536e-01  4.85155284e-01 -1.40147312e-02
   2.31904259e+01  1.00758598e+02 -1.02851488e-01 -1.68466419e-01
  -4.07394648e+00  3.90548015e+00  1.08355499e+02  1.09852005e+02
   1.09215248e+02  1.09970001e+02  8.40000000e+01  4.80000000e+01
   3.60000000e+01  6.66869812e+01  7.43140182e+01 -3.39326134e+01
   6.59881744e+01  9.16097107e+01  8.24533844e+01 -8.39028740e+00
   2.98259318e-01  6.35504723e-02  6.35623932e-02 -8.66575241e+00]
 [ 1.08640999e+02  1.08730003e+02  1.08522003e+02  1.08557999e+02
   3.06729004e+03 -9.28638306e+02 -3.06729004e+03  1.08250403e+03
   1.26794472e-01 -9.15853500e+00  2.33519745e-06 -7.24810600e-01
   1.42998926e+03  1.71024501e-01  1.08777222e+02  1.07919281e+02
   1.08348251e+02  0.00000000e+00  0.00000000e+00  1.08517998e+02
   1.08678802e+02  1.08357201e+02  0.00000000e+00  0.00000000e+00
   1.08681999e+02  1.08011002e+02  0.00000000e+00  0.00000000e+00
  -1.09943030e-02 -9.10345688e-02  8.00402686e-02  1.08491196e+02
   1.08502190e+02  2.00000000e+01  2.00000000e+01  2.00000000e+01
   1.24103582e+00  7.23114371e-01  5.17921507e-01 -1.10507384e-02
   2.32164898e+01  8.33211060e+01 -2.04252243e-01  3.73800069e-01
  -3.09073043e+00  3.46453047e+00  1.08423248e+02  1.09848495e+02
   1.09153252e+02  1.09970001e+02  8.00000000e+01  4.40000000e+01
   3.60000000e+01  5.76653519e+01  7.08789597e+01 -3.26422539e+01
   5.85831795e+01  7.74862976e+01  8.37895737e+01 -2.25137062e+01
   3.05625647e-01 -7.82370567e-02 -7.82966614e-02 -8.73721218e+00]
 [ 1.08557999e+02  1.08601997e+02  1.08511002e+02  1.08535004e+02
   2.21551001e+03 -3.05240405e+03 -2.21551001e+03  4.88959015e+02
   6.14854693e-02  4.53650818e+01  2.03640298e-06 -2.86905169e+00
   1.42968640e+03  1.65308163e-01  1.08796371e+02  1.07924431e+02
   1.08360397e+02  0.00000000e+00  0.00000000e+00  1.08546402e+02
   1.08688301e+02  1.08404495e+02  0.00000000e+00  0.00000000e+00
   1.08681999e+02  1.08011002e+02  0.00000000e+00  0.00000000e+00
  -6.68538827e-03 -7.41647333e-02  6.74793497e-02  1.08497940e+02
   1.08504623e+02  2.00000000e+01  2.00000000e+01  2.00000000e+01
   1.25397086e+00  7.88119197e-01  4.65851635e-01 -8.48838966e-03
   2.32311954e+01  6.02451668e+01 -1.19402312e-01  9.04350698e-01
  -2.15415168e+00  3.05850244e+00  1.08445251e+02  1.09848495e+02
   1.09082748e+02  1.09899506e+02  7.60000000e+01  4.00000000e+01
   3.60000000e+01  5.53288651e+01  6.51603088e+01 -3.15207710e+01
   5.38951721e+01  7.00001144e+01  7.96987076e+01 -2.99998817e+01
   2.81907469e-01 -2.11834908e-02 -2.11715698e-02 -8.75654221e+00]
 [ 1.08536003e+02  1.08605003e+02  1.08512001e+02  1.08537003e+02
   1.56271997e+03 -1.76925171e+03  1.56271997e+03  4.28656006e+02
   7.76533335e-02  3.15900936e+01  1.26866485e-06 -4.40513432e-01
   1.42971265e+03  1.60143450e-01  1.08814148e+02  1.07936554e+02
   1.08375351e+02  0.00000000e+00  0.00000000e+00  1.08565636e+02
   1.08708939e+02  1.08422333e+02  0.00000000e+00  0.00000000e+00
   1.08681999e+02  1.08011002e+02  0.00000000e+00  0.00000000e+00
  -3.07381502e-03 -5.99465519e-02  5.68727367e-02  1.08503944e+02
   1.08507019e+02  2.00000000e+01  2.00000000e+01  2.00000000e+01
   1.18889093e+00  8.23916435e-01  3.64974469e-01 -6.28511701e-03
   2.32374897e+01  5.58972931e+01 -5.13523109e-02  1.37313008e+00
  -1.28256428e+00  2.65569448e+00  1.08462502e+02  1.09848495e+02
   1.09021500e+02  1.09899506e+02  7.20000000e+01  3.60000000e+01
   3.60000000e+01  5.55096741e+01  6.54075394e+01 -3.04974308e+01
   4.59528275e+01  7.03076401e+01  7.25980148e+01 -2.96923599e+01
   2.67404795e-01  1.83582306e-03  1.85966492e-03 -8.75486183e+00]]

Reshaping dataset & creating labels...
---------------------------------------------------------------
Train Partition Reshaped (Top 2):
(2603, 100, 64)
[[[ 1.1894000e+02  1.1901600e+02  1.1892600e+02 ...  1.4185929e+01
    0.0000000e+00  0.0000000e+00]
  [ 1.1894700e+02  1.1897500e+02  1.1893300e+02 ... -1.6808510e-03
   -1.7166138e-03 -1.6808510e-03]
  [ 1.1895400e+02  1.1897500e+02  1.1889300e+02 ...  8.4042549e-03
    8.4400177e-03  6.7234039e-03]
  ...
  [ 1.1858000e+02  1.1864500e+02  1.1857000e+02 ... -9.2804432e-03
   -9.2506409e-03 -3.2029748e-01]
  [ 1.1857500e+02  1.1861000e+02  1.1855900e+02 ...  1.6808510e-03
    1.6689301e-03 -3.1861663e-01]
  [ 1.1857500e+02  1.1861000e+02  1.1854300e+02 ...  3.2055378e-02
    3.2043457e-02 -2.8666854e-01]]

 [[ 1.1861800e+02  1.1861800e+02  1.1851300e+02 ... -6.6608191e-02
   -6.6614151e-02 -3.5308599e-01]
  [ 1.1853700e+02  1.1854600e+02  1.1844500e+02 ... -2.5272369e-03
   -2.5272369e-03 -3.5560727e-01]
  [ 1.1853200e+02  1.1856400e+02  1.1850300e+02 ...  1.9407272e-02
    1.9407272e-02 -3.3626556e-01]
  ...
  [ 1.1751500e+02  1.1751500e+02  1.1745100e+02 ... -3.9994717e-02
   -4.0006638e-02 -1.2408435e+00]
  [ 1.1747500e+02  1.1751000e+02  1.1738100e+02 ...  8.4638596e-04
    8.5830688e-04 -1.2400031e+00]
  [ 1.1748400e+02  1.1756500e+02  1.1744100e+02 ...  7.5769424e-02
    7.5769424e-02 -1.1651814e+00]]]
Test Partition Reshaped (Top 2):
(650, 100, 64)
[[[ 1.0836400e+02  1.0847000e+02  1.0835500e+02 ...  8.4900856e-02
    8.4877014e-02 -8.8229599e+00]
  [ 1.0845400e+02  1.0863400e+02  1.0842400e+02 ...  1.1433363e-01
    1.1425018e-01 -8.7187109e+00]
  [ 1.0858500e+02  1.0868500e+02  1.0849100e+02 ...  9.3936920e-02
    9.3889236e-02 -8.6329641e+00]
  ...
  [ 1.0725800e+02  1.0734000e+02  1.0721700e+02 ... -2.0515919e-02
   -2.0503998e-02 -9.8485889e+00]
  [ 1.0723800e+02  1.0741000e+02  1.0723800e+02 ...  1.2961626e-01
    1.2950897e-01 -9.7317333e+00]
  [ 1.0737600e+02  1.0741400e+02  1.0728100e+02 ...  0.0000000e+00
    0.0000000e+00 -9.7317333e+00]]

 [[ 1.0737300e+02  1.0737300e+02  1.0726200e+02 ... -2.8866529e-02
   -2.8848648e-02 -9.7577934e+00]
  [ 1.0734200e+02  1.0740500e+02  1.0729800e+02 ... -2.8878450e-02
   -2.8896332e-02 -9.7838516e+00]
  [ 1.0731300e+02  1.0738700e+02  1.0718600e+02 ... -1.0716915e-01
   -1.0724068e-01 -9.8805370e+00]
  ...
  [ 1.0665900e+02  1.0681800e+02  1.0665900e+02 ...  3.2818317e-02
    3.2806396e-02 -1.0304242e+01]
  [ 1.0669200e+02  1.0672100e+02  1.0658600e+02 ... -6.2799454e-02
   -6.2799454e-02 -1.0360569e+01]
  [ 1.0662900e+02  1.0669200e+02  1.0653400e+02 ... -8.0651045e-02
   -8.0680847e-02 -1.0432863e+01]]]
Train Partition Labels Reshaped (Top 10):
(2603,)
[-7.54983409 -9.80486924  9.6261932  -9.38195752 -6.48836002 -9.55453585
 -9.75084855 -9.482147    9.5379021   7.80904772]
Test Partition Labels Reshaped (Top 10):
(650,)
[-9.58271928 -9.18973528  9.6857834   7.31175347 -8.23538932  9.24321561
  9.4814995  -9.59891056  9.60882866 -8.34505454]

Building The Model...
---------------------------------------------------------------
2019-04-30 19:09:57.901622: I tensorflow/core/platform/cpu_feature_guard.cc:142] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2
2019-04-30 19:09:57.904506: I tensorflow/stream_executor/platform/default/dso_loader.cc:42] Successfully opened dynamic library nvcuda.dll
2019-04-30 19:09:58.061769: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1551] Found device 0 with properties:
name: GeForce GTX 1080 Ti major: 6 minor: 1 memoryClockRate(GHz): 1.645
pciBusID: 0000:01:00.0
totalMemory: 11.00GiB freeMemory: 9.11GiB
2019-04-30 19:09:58.065548: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1674] Adding visible gpu devices: 0
2019-04-30 19:09:58.471675: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1082] Device interconnect StreamExecutor with strength 1 edge matrix:
2019-04-30 19:09:58.473471: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1088]      0
2019-04-30 19:09:58.474763: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1101] 0:   N
2019-04-30 19:09:58.476094: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1222] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 8789 MB memory) -> physical GPU (device: 0, name: GeForce GTX 1080 Ti, pci bus id: 0000:01:00.0, compute capability: 6.1)
[<tf.Tensor 'lstm_input:0' shape=(1, 100, 64) dtype=float32>]
Model: "sequential"
_________________________________________________________________
Layer (type)                 Output Shape              Param #
=================================================================
lstm (LSTM)                  (1, 32)                   12416
_________________________________________________________________
dropout (Dropout)            (1, 32)                   0
_________________________________________________________________
dense (Dense)                (1, 1)                    33
=================================================================
Total params: 12,449
Trainable params: 12,449
Non-trainable params: 0
_________________________________________________________________

Testing 10 widthed batch...
---------------------------------------------------------------
Real Labels:
[-7.54983409 -9.80486924  9.6261932  -9.38195752 -6.48836002 -9.55453585
 -9.75084855 -9.482147    9.5379021   7.80904772]
Predicted Labels:
[[ 0.01582426]
 [ 0.5347598 ]
 [ 0.0657839 ]
 [ 0.6459428 ]
 [-0.12520947]
 [ 0.6920755 ]
 [ 0.22799453]
 [ 0.26303905]
 [ 0.4469554 ]
 [-0.19751588]]

Fitting the model...
---------------------------------------------------------------
stateful training epoch 1/3
Train on 2082 samples, validate on 521 samples
2082/2082 [==============================] - 156s 75ms/sample - loss: 68.9208 - val_loss: 65.3465
stateful training epoch 2/3
Train on 2082 samples, validate on 521 samples
2082/2082 [==============================] - 155s 74ms/sample - loss: 68.7262 - val_loss: 65.6489
stateful training epoch 3/3
Train on 2082 samples, validate on 521 samples
2082/2082 [==============================] - 155s 74ms/sample - loss: 68.5694 - val_loss: 65.6835

Evaluating the model...
---------------------------------------------------------------
[-9.58271928 -9.18973528  9.6857834   7.31175347 -8.23538932  9.24321561
  9.4814995  -9.59891056  9.60882866 -8.34505454]
10/10 [==============================] - 0s 30ms/sample
[[ 0.5456061 ]
 [-0.19695748]
 [-0.17199089]
 [-0.10854629]
 [-0.11880323]
 [-0.27384144]
 [-0.04704979]
 [-0.03765476]
 [-0.0125788 ]
 [-0.04881904]]
Testing set MSE: 68.24

Saving final weights...
Finished.